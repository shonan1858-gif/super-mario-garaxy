# Mini Galaxy Runner

ChatGPT共有設計を元にした、**マリオギャラクシー風MVP**（球面重力 + 接線移動 + ゴール判定）のブラウザ実装です。

## セットアップ

```bash
npm install
npm run dev
```

## 操作

- `WASD`: 移動（カメラ相対 / 接線平面）
- マウス: カメラ回転（クリックでポインタロック）
- `Space`: ジャンプ（接地中のみ）
- `Shift`: ダッシュ（移動速度と加速が上昇）
- `R`: リスタート

## 3段ジャンプ仕様

- ジャンプは接地時のみ実行されます（空中ジャンプ不可）。
- ジャンプ方向は、常に局所 `Up`（惑星中心向き重力の反対方向）です。
- ジャンプ強度は `1 → 2 → 3段` で増加します。
  - `jumpImpulse = [7.0, 8.5, 10.0]`
- 段数コンボは、**着地後 0.7秒以内**に次ジャンプ入力で継続します。
- `0.7秒` を超えると段数は1段目にリセットされます。
- 入力バッファを `0.15秒` 持ち、着地直前入力の取りこぼしを軽減しています。

## 追加した新要素

- ブーメランを投げる敵を1体追加
  - 敵は一定間隔でブーメランを前方へ投げ、戻ってくる挙動をします。
  - ブーメランがプレイヤーに当たると軽くノックバックします。
- 建物（プロップ）を3つ追加
  - 惑星表面に沿って3つの建物を配置しました。
- ダッシュ追加
  - Shift押下中に移動系パラメータを強化しています。

## 実装済みMVP要素

- 球体惑星（半径100）
- 球面重力（惑星中心方向へ一定加速度）
- 局所Upに沿う接線移動
- 接地レイ判定 + 3段ジャンプ
- 三人称カメラ（局所Up追従）
- ゴールリング接触でCLEAR表示
- 外周落下でリスポーン
- HUD（Speed / Grounded / JumpCombo / Dash）

## 手動テスト項目

1. 起動後、惑星・プレイヤー・ゴールリング・敵・建物3つが表示される。
2. `WASD`で移動でき、惑星を回っても操作方向が破綻しない。
3. `Shift + WASD`で通常移動より速く移動できる。
4. `Space`で接地時のみジャンプする（空中ではジャンプしない）。
5. 着地後0.7秒以内に連続で`Space`すると1→2→3段の順で高く跳ぶ。
6. 敵のブーメランが往復し、接触でプレイヤーが軽く弾かれる。
7. ゴールリングに触れると`CLEAR! Press R to Restart`が表示される。
8. 画面外へ落下した場合、自動で初期位置にリスポーンする。
9. `R`で即時リスタートできる。
